/*
 * JBL Header Schema
 *
 * The basic building block of a JBL document. The header offers details
 * about who wrote the document, and how to go about confirming it really
 * is valid.
 *
 */
{
  "name": "header",
  "description": "Meta-data describing the JBL payload object.",

  /* The properties */
  "properties": {

    /* Basic header fields */
    "language": {
      "type": "string",
      "description": "Standard identifier.",
      "default": "JBL",
      "required": true
    },
    "version": {
      "type": "string",
      "description": "The JBL version used to describe the document.",
      "required": true
    },
    "payload": {
      "type": "object",
      "required": true,
      "properties": {
        "key": {
          "type": "string",
          "description": "The key of the payload object that should be read.",
          "required": true
        },
        "schema": {
          "type": "string",
          "description": "The schema to be used to interpret the payload object.",
          "required": false
        }
      }
    },
    "generator": {
      "type": "string",
      "description": "Name of the application or project used to generate the document."
    },

    /* Authors or contributors to the project */
    "authors": {
      "type": "array",
      "description": "The people involved in the creation of the document.",
      "items": {
        "type": "object",
        "description": "Details for a single author of the document.",
        "properties": {
          "alias": {
            "type": "string",
            "description": "A brief nickname, signature, or initials used to quickly associate the author with other parts of the document. Should be unique per document.",
            "required": true
          },
          "name": {
            "type": "string",
            "description": "Full name of the person to attribute to the document.",
            "required": true
          },
          "role": {
            "type": "string",
            "description": "What action or role did the author perform in the document."
          }
        }
      }
    },

    "history": {
      "type": "object",
      "description": "Details of the changes made to the document.",
      "required": true,
      "properties": {
        "created_at": {
          "type": "string",
          "description": "A time stamp for when the document was first generated or created.",
          "required": true
        },
        "updated_at": {
          "type": "string",
          "description": "A time stamp for when the document was last updated.",
          "required": true
        },
        "changes": {
          "type": "array",
          "description": "An array of changes in chronological order performed by the authors.",
          "required": false,
          "items": {
            "type": "object",
            "properties": {
              "at": {
                "type": "string",
                "description": "Timestamp of the change.",
                "required": true
              },
              "by_alias": {
                "type": "string",
                "description": "The alias of the author who performed the change"
              },
              "location": {
                "type": "string",
                "description": "Name of the location where the change was performed."
              },
              "version": {
                "type": "string",
                "description": "Version of the document that resulted from this change."
              },
              "description" {
                "type": "string",
                "description": "Brief description of the change."
              }
            }
          }
        }
      }
    },

    /* Digest handling */
    "digest": {
      "type": "object",
      "description": "The digest hash used to confirm the document has not been tampered with in transit.",
      "required": false,
      "properties": {
        "algorithm": {
          "type": "string",
          "description": "The type of digest algorithm to use, as described by the JBL standard.",
          "default": "SHA256",
          "required": true
        },
        "value": {
          "type": "string",
          "description": "Actual value of the digest obtained from performing the algorithm."
        }
      }
    },


    /* Signature handling */
    "signature": {
      "type": "object",
      "description": "The signature used to confirm the document was truly generated by the author.",
      "required": false,
      "properties": {
        "algorithm": {
          "type": "string",
          "description": "The type of digest algorithm to use, as described by the JBL standard.",
          "default": "X509-RSA-SHA1",
          "required": true
        },
        "value": {
          "type": "string",
          "description": "Actual value of the digital signature obtained from performing the algorithm.",
          "required": true
        },
        "x509_data": {
          "$ref": "x509_data",
          "description": "X509 certificate data used to sign the documents data.",
          "required": true
        }
      }
    }

    /* Encruption handling */
    /* NOT YET IMPLEMENTED! */

  }
}
